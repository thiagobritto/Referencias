
<!DOCTYPE html>

<html lang="pt_BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

    <title>Python no Windows &#8212; documentação Python 3.10.4</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pydoctheme.css?2022.1" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Pesquisar dentro de documentação Python 3.10.4"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="Sobre esses documentos" href="../about.html" />
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Buscar" href="../search.html" />
    <link rel="copyright" title="Direitos autorais" href="../copyright.html" />
    <link rel="next" title="FAQ da Interface Gráfica do Usuário" href="gui.html" />
    <link rel="prev" title="FAQ sobre Extensão/Incorporação" href="extending.html" />
    <link rel="canonical" href="https://docs.python.org/3/faq/windows.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="shortcut icon" type="image/png" href="../_static/py.svg" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script> 

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <label for="menuToggler" class="toggler__label">
        <span></span>
    </label>
    <nav class="nav-content" role="navigation">
         <a href="https://www.python.org/" class="nav-logo">
             <img src="../_static/py.svg" alt="Logo"/>
         </a>
        <div class="version_switcher_placeholder"></div>
        <form role="search" class="search" action="../search.html" method="get">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                <path fill-rule="nonzero"
                        d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#444"></path>
            </svg>
            <input type="text" name="q" aria-label="Busca rápida"/>
            <input type="submit" value="Ir"/>
        </form>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
  <h3><a href="../contents.html">Tabela de Conteúdo</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python no Windows</a><ul>
<li><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows">Como faço para executar um programa Python no Windows?</a></li>
<li><a class="reference internal" href="#how-do-i-make-python-scripts-executable">Como eu faço para criar programas Python executáveis?</a></li>
<li><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start">Por que Python às vezes demora tanto para iniciar?</a></li>
<li><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script">Como eu faço para criar um executável a partir de um código Python?</a></li>
<li><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll">Um arquivo <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> é o mesmo que um DLL?</a></li>
<li><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application">Como eu posso embutir Python dentro de uma aplicação do Windows?</a></li>
<li><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">Como eu impeço editores de adicionarem tabulações na minha source do Python?</a></li>
<li><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking">Como faço para verificar uma tecla pressionada sem bloquear?</a></li>
</ul>
</li>
</ul>

  <h4>Tópico anterior</h4>
  <p class="topless"><a href="extending.html"
                        title="capítulo anterior">FAQ sobre Extensão/Incorporação</a></p>
  <h4>Próximo tópico</h4>
  <p class="topless"><a href="gui.html"
                        title="próximo capítulo">FAQ da Interface Gráfica do Usuário</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Relatar um erro</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/3.10/Doc/faq/windows.rst"
            rel="nofollow">Exibir código-fonte
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegação</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice geral"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Índice de Módulos Python"
             >módulos</a> |</li>
        <li class="right" >
          <a href="gui.html" title="FAQ da Interface Gráfica do Usuário"
             accesskey="N">próximo</a> |</li>
        <li class="right" >
          <a href="extending.html" title="FAQ sobre Extensão/Incorporação"
             accesskey="P">anterior</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.10.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Perguntas Frequentes Sobre Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python no Windows</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Busca rápida" aria-label="Busca rápida" type="text" name="q" />
          <input type="submit" value="Ir" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="python-on-windows-faq">
<span id="windows-faq"></span><h1><a class="toc-backref" href="#id1">Python no Windows</a><a class="headerlink" href="#python-on-windows-faq" title="Link permanente para este título">¶</a></h1>
<div class="contents topic" id="sumario">
<p class="topic-title">Sumário</p>
<ul class="simple">
<li><p><a class="reference internal" href="#python-on-windows-faq" id="id1">Python no Windows</a></p>
<ul>
<li><p><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows" id="id2">Como faço para executar um programa Python no Windows?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-make-python-scripts-executable" id="id3">Como eu faço para criar programas Python executáveis?</a></p></li>
<li><p><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start" id="id4">Por que Python às vezes demora tanto para iniciar?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script" id="id5">Como eu faço para criar um executável a partir de um código Python?</a></p></li>
<li><p><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll" id="id6">Um arquivo <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> é o mesmo que um DLL?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application" id="id7">Como eu posso embutir Python dentro de uma aplicação do Windows?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source" id="id8">Como eu impeço editores de adicionarem tabulações na minha source do Python?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking" id="id9">Como faço para verificar uma tecla pressionada sem bloquear?</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="how-do-i-run-a-python-program-under-windows">
<span id="faq-run-program-under-windows"></span><h2><a class="toc-backref" href="#id2">Como faço para executar um programa Python no Windows?</a><a class="headerlink" href="#how-do-i-run-a-python-program-under-windows" title="Link permanente para este título">¶</a></h2>
<p>Esta não é necessariamente uma questão direta. Se você já está familiarizado com a execução de programas através das linha de comando do Windows, então tudo parecerá óbvio; caso contrário, poderá precisar de um pouco mais de orientação.</p>
<p>Unless you use some sort of integrated development environment, you will end up
<em>typing</em> Windows commands into what is referred to as a
“Command prompt window”.  Usually you can create such a window from your
search bar by searching for <code class="docutils literal notranslate"><span class="pre">cmd</span></code>.  You should be able to recognize
when you have started such a window because you will see a Windows “command
prompt”, which usually looks like this:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\&gt;</span>
</pre></div>
</div>
<p>A letra pode ser diferente, e pode haver outras coisas depois, então você facilmente pode ver algo como:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">D:\YourName\Projects\Python&gt;</span>
</pre></div>
</div>
<p>dependendo de como seu computador foi configurado e o que mais você tem feito com ele recentemente. Uma vez que você tenha iniciado a janela, você estará no caminho para executar os seus programas Python.</p>
<p>Você deve observar que seu código Python deve ser processado por outro programa chamado interpretador. O interpretador lê o seu código, compila em bytecodes, e depois executa os bytecodes para rodar o seu programa. Então, como você pode organizar o interpretador para lidar com seu Python?</p>
<p>Primeiro, você precisa ter certeza de que sua janela de comando reconhece a palavra “py” como uma instrução para iniciar o interpretador. Se você abriu a janela de comando, você deve tentar digitar o comando “py” e o observar o retorno:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\Users\YourName&gt;</span> py
</pre></div>
</div>
<p>Você deve então ver algo como:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">Python 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:04:45) [MSC v.1900 32 bit (Intel)] on win32</span>
<span class="go">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Você iniciou o interpretador no “modo interativo”. Que significa que você pode inserir instruções ou expressões Python interativamente e executá-las ou calculá-las enquanto espera. Esta é uma das características mais fortes do Python. Verifique isso digitando algumas instruções de sua escolha e veja os resultados:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="go">Hello</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;Hello&quot;</span> <span class="o">*</span> <span class="mi">3</span>
<span class="go">&#39;HelloHelloHello&#39;</span>
</pre></div>
</div>
<p>Muitas pessoas usam o modo interativo como uma calculadora conveniente, mas altamente programável. Quando quiser encerrar sua sessão interativa do Python, chame a função <a class="reference internal" href="../library/constants.html#exit" title="exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">exit()</span></code></a> ou mantenha pressionada a tecla <kbd class="kbd docutils literal notranslate">Ctrl</kbd> enquanto você digita a <kbd class="kbd docutils literal notranslate">Z</kbd> e pressione a tecla “<kbd class="kbd docutils literal notranslate">Enter</kbd>” para voltar ao prompt de comando do Windows.</p>
<p>Você também pode descobrir que você tem um item no Menu Iniciar como <span class="menuselection">Iniciar ‣ Programas‣ Python 3.x ‣ Python (linha de comando)</span> que resultará em você vendo o prompt <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> em uma nova janela. Se acontecer isso, a janela desaparecerá depois que você chamar a função <a class="reference internal" href="../library/constants.html#exit" title="exit"><code class="xref py py-func docutils literal notranslate"><span class="pre">exit()</span></code></a> ou inserir o caractere <kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>-<kbd class="kbd docutils literal notranslate">Z</kbd></kbd>; o Windows está executando um único comando “python” na janela, e fecha quando você termina o interpretador.</p>
<p>Agora que sabemos que o comando <code class="docutils literal notranslate"><span class="pre">py</span></code> é reconhecido, você pode dar seu script Python para ele. Você terá que dar um caminho absoluto ou relativo para o script Python. Vamos dizer que seu script Python está localizado na sua área de trabalho e se chama <code class="docutils literal notranslate"><span class="pre">hello.py</span></code>, e seu prompt de comando está aberto no seu diretório raiz de forma que você está vendo algo similar a:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\YourName&gt;
</pre></div>
</div>
<p>Então, agora você solicitará o comando <code class="docutils literal notranslate"><span class="pre">py</span></code> para fornecer seu script para Python, digitando <code class="docutils literal notranslate"><span class="pre">py</span></code> seguido pelo seu caminho de script:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>C:\Users\YourName&gt; py Desktop\hello.py
hello
</pre></div>
</div>
</section>
<section id="how-do-i-make-python-scripts-executable">
<h2><a class="toc-backref" href="#id3">Como eu faço para criar programas Python executáveis?</a><a class="headerlink" href="#how-do-i-make-python-scripts-executable" title="Link permanente para este título">¶</a></h2>
<p>No Windows, o instalador padrão do Python já associa a extensão .py com o tipo de arquivo (Python.File) e dá àquele tipo de arquivo um comando aberto que executa o interpretador (<code class="docutils literal notranslate"><span class="pre">D:\Program</span> <span class="pre">Files\Python\python.exe</span> <span class="pre">&quot;%1&quot;</span> <span class="pre">%*</span></code>). Isso é o bastante para fazer scripts executáveis pelo prompt de comando como ‘foo.py’. Se você preferir executar o script simplesmente digitando ‘foo’ sem extensão você precisa adicionar .py à variável de ambiente PATHEXT.</p>
</section>
<section id="why-does-python-sometimes-take-so-long-to-start">
<h2><a class="toc-backref" href="#id4">Por que Python às vezes demora tanto para iniciar?</a><a class="headerlink" href="#why-does-python-sometimes-take-so-long-to-start" title="Link permanente para este título">¶</a></h2>
<p>Geralmente, Python inicia muito rapidamente no Windows, mas ocasionalmente há relatos de erros que, de repente, o Python começa a demorar muito tempo para iniciar. Isso é ainda mais intrigante, porque Python funciona bem em outros sistemas Windows que parecem estar configurados de forma idêntica.</p>
<p>O problema pode ser causado por uma desconfiguração de software antivírus na máquina problemática. Alguns antivírus são conhecidos por introduzir sobrecarga de duas ordens de magnitude no início quando estão configurados para monitorar todas as leituras do sistema de arquivos. Tente verificar a configuração do antivírus nos seus sistemas para assegurar que eles estão de fato configurados identicamente. O McAfee, quando configurado para escanear todo a atividade do sistema de arquivos, é um ofensor conhecido.</p>
</section>
<section id="how-do-i-make-an-executable-from-a-python-script">
<h2><a class="toc-backref" href="#id5">Como eu faço para criar um executável a partir de um código Python?</a><a class="headerlink" href="#how-do-i-make-an-executable-from-a-python-script" title="Link permanente para este título">¶</a></h2>
<p>Consulte <a class="reference internal" href="programming.html#faq-create-standalone-binary"><span class="std std-ref">Como posso criar um binário independente a partir de um script Python?</span></a> para uma lista de ferramentas que podem ser usada para criar executáveis.</p>
</section>
<section id="is-a-pyd-file-the-same-as-a-dll">
<h2><a class="toc-backref" href="#id6">Um arquivo <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> é o mesmo que um DLL?</a><a class="headerlink" href="#is-a-pyd-file-the-same-as-a-dll" title="Link permanente para este título">¶</a></h2>
<p>Sim, os arquivos .pyd são dll, mas existem algumas diferenças. Se você possui uma DLL chamada <code class="docutils literal notranslate"><span class="pre">foo.pyd</span></code>, ela deve ter a função <code class="docutils literal notranslate"><span class="pre">PyInit_foo()</span></code>. Você pode escrever “import foo” do Python, e o Python procurará por foo.pyd (assim como foo.py, foo.pyc) e, se o encontrar, tentará chamar <code class="docutils literal notranslate"><span class="pre">PyInit_foo()</span></code> para inicializá-lo. Você não vincula seu arquivo .exe ao arquivo foo.lib, pois isso faria com que o Windows exigisse a presença da DLL.</p>
<p>Observe que o caminho de pesquisa para foo.pyd é PYTHONPATH, não o mesmo que o Windows usa para procurar por foo.dll. Além disso, foo.pyd não precisa estar presente para executar seu programa, enquanto que se você vinculou seu programa a uma dll, a dll será necessária. Obviamente, o foo.pyd é necessário se você quiser dizer <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">foo</span></code>. Em uma DLL, o vínculo é declarado no código-fonte com <code class="docutils literal notranslate"><span class="pre">__declspec(dllexport)</span></code>. Em um .pyd, o vínculo é definido em uma lista de funções disponíveis.</p>
</section>
<section id="how-can-i-embed-python-into-a-windows-application">
<h2><a class="toc-backref" href="#id7">Como eu posso embutir Python dentro de uma aplicação do Windows?</a><a class="headerlink" href="#how-can-i-embed-python-into-a-windows-application" title="Link permanente para este título">¶</a></h2>
<p>A incorporação do interpretador Python em um aplicativo do Windows pode ser resumida da seguinte forma:</p>
<ol class="arabic">
<li><p>_Não_ compile o Python diretamente em seu arquivo .exe. No Windows, o Python deve ser uma DLL para manipular os módulos de importação que são eles próprios. (Este é o primeiro fato chave não documentado.) Em vez disso, vincule a <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>; normalmente é instalado em <code class="docutils literal notranslate"><span class="pre">C:\Windows\System</span></code>. <em>NN</em> é a versão do Python, um número como “33” para o Python 3.3.</p>
<p>Você pode vincular ao Python de duas maneiras diferentes. A vinculação em tempo de carregamento significa vincular contra <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></code>, enquanto a vinculação em tempo de execução significa vincular a <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>. (Nota geral: <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></code> é a chamada “import lib” correspondente a <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code>. Apenas define símbolos para o vinculador.)</p>
<p>A vinculação em tempo de execução simplifica bastante as opções de vinculação; tudo acontece em tempo de execução. Seu código deve carregar <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code> usando a rotina <code class="docutils literal notranslate"><span class="pre">LoadLibraryEx()</span></code> do Windows. O código também deve usar rotinas de acesso e dados em <code class="file docutils literal notranslate"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></code> (ou seja, as APIs C do Python) usando ponteiros obtidos pela rotina <code class="docutils literal notranslate"><span class="pre">GetProcAddress()</span></code> do Windows. As macros podem tornar o uso desses ponteiros transparente para qualquer código C que chama rotinas na API C do Python.</p>
</li>
<li><p>Se você usa SWIG, é fácil criar um “módulo de extensão” do Python que disponibilizará os dados e os métodos da aplicação para o Python. O SWIG cuidará de todos os detalhes obscuros para você. O resultado é o código C que você vincula <em>ao</em> arquivo.exe (!) Você _não_ precisa criar um arquivo DLL, o que também simplifica a vinculação.</p></li>
<li><p>O SWIG criará uma função init (uma função C) cujo nome depende do nome do módulo de extensão. Por exemplo, se o nome do módulo for leo, a função init será chamada initleo(). Se você usa classes de sombra SWIG, como deveria, a função init será chamada initleoc(). Isso inicializa uma classe auxiliar principalmente oculta usada pela classe shadow.</p>
<p>O motivo pelo qual você pode vincular o código C na etapa 2 ao seu arquivo .exe é que chamar a função de inicialização equivale a importar o módulo para o Python! (Este é o segundo fato chave não documentado.)</p>
</li>
<li><p>Em suma, você pode utilizar o código a seguir para inicializar o interpretador Python com seu módulo de extensão.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;python.h&quot;</span><span class="cp"></span>
<span class="p">...</span><span class="w"></span>
<span class="n">Py_Initialize</span><span class="p">();</span><span class="w">  </span><span class="c1">// Initialize Python.</span>
<span class="n">initmyAppc</span><span class="p">();</span><span class="w">  </span><span class="c1">// Initialize (import) the helper class.</span>
<span class="n">PyRun_SimpleString</span><span class="p">(</span><span class="s">&quot;import myApp&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Import the shadow class.</span>
</pre></div>
</div>
</li>
<li><p>Existem dois problemas com a API C do Python que se tornarão aparentes se você utiliza um compilador que não seja o MSVC, o compilador utilizado no pythonNN.dll.</p>
<p>Problema 1: As chamadas funções de “Nível Muito Alto” que recebem argumentos FILE * não funcionarão em um ambiente com vários compiladores porque a noção de cada struct FILE de um compilador será diferente. Do ponto de vista da implementação, essas são funções de nível muito baixo.</p>
<p>Problema 2: SWIG gera o seguinte código ao gerar envólucros para funções sem retorno:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Py_INCREF</span><span class="p">(</span><span class="n">Py_None</span><span class="p">);</span><span class="w"></span>
<span class="n">_resultobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Py_None</span><span class="p">;</span><span class="w"></span>
<span class="k">return</span><span class="w"> </span><span class="n">_resultobj</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Infelizmente, Py_None é uma macro que se expande para uma referência a uma estrutura de dados complexa chamada _Py_NoneStruct dentro de pythonNN.dll. Novamente, esse código falhará em um ambiente com vários compiladores. Substitua esse código por:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">return</span><span class="w"> </span><span class="n">Py_BuildValue</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Pode ser possível usar o comando <code class="docutils literal notranslate"><span class="pre">%typemap</span></code> do SWIG para fazer a alteração automaticamente, embora eu não tenha conseguido fazer isso funcionar (eu sou um completo novato em SWIG).</p>
</li>
<li><p>Usar um script de shell do Python para criar uma janela do interpretador Python de dentro da aplicação do Windows não é uma boa ideia; a janela resultante será independente do sistema de janelas da sua aplicação. Em vez disso, você (ou a classe wxPythonWindow) deve criar uma janela “nativa” do interpretador. É fácil conectar essa janela ao interpretador Python. Você pode redirecionar a E/S do Python para qualquer objeto que suporte leitura e gravação; portanto, tudo que você precisa é de um objeto Python (definido no seu módulo de extensão) que contenha métodos read() e write().</p></li>
</ol>
</section>
<section id="how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">
<h2><a class="toc-backref" href="#id8">Como eu impeço editores de adicionarem tabulações na minha source do Python?</a><a class="headerlink" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source" title="Link permanente para este título">¶</a></h2>
<p>As perguntas frequentes não recomendam a utilização de tabulações, e o guia de estilo Python, :pep:<cite>8</cite>, recomenda 4 espaços para código de Python distribuído; esse também é o padrão do python-mode do Emacs.</p>
<p>Sob qualquer editor, misturar tabulações e espaços é uma má ideia. O MSVC não é diferente nesse aspecto e é facilmente configurado para usar espaços: Selecione <span class="menuselection">Tools ‣ Options ‣ Tabs</span> e, para o tipo de arquivo “Default”, defina “Tab size” e “Indent size” para 4 e selecione o botão de opção “Insert spaces”.</p>
<p>O Python levanta <a class="reference internal" href="../library/exceptions.html#IndentationError" title="IndentationError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">IndentationError</span></code></a> ou <a class="reference internal" href="../library/exceptions.html#TabError" title="TabError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TabError</span></code></a> se tabulações e espaços misturados estiverem causando problemas no espaço em branco à esquerda. Você também pode executar o módulo <a class="reference internal" href="../library/tabnanny.html#module-tabnanny" title="tabnanny: Tool for detecting white space related problems in Python source files in a directory tree."><code class="xref py py-mod docutils literal notranslate"><span class="pre">tabnanny</span></code></a> para verificar uma árvore de diretórios no modo em lote.</p>
</section>
<section id="how-do-i-check-for-a-keypress-without-blocking">
<h2><a class="toc-backref" href="#id9">Como faço para verificar uma tecla pressionada sem bloquear?</a><a class="headerlink" href="#how-do-i-check-for-a-keypress-without-blocking" title="Link permanente para este título">¶</a></h2>
<p>Use o módulo <a class="reference internal" href="../library/msvcrt.html#module-msvcrt" title="msvcrt: Miscellaneous useful routines from the MS VC++ runtime. (Windows)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">msvcrt</span></code></a>. Este é um módulo de extensão padrão específico do Windows. Ele define uma função <code class="docutils literal notranslate"><span class="pre">kbhit()</span></code> que verifica se um toque no teclado está presente, e <code class="docutils literal notranslate"><span class="pre">getch()</span></code> que recebe um caractere sem ecoá-lo.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Tabela de Conteúdo</a></h3>
  <ul>
<li><a class="reference internal" href="#">Python no Windows</a><ul>
<li><a class="reference internal" href="#how-do-i-run-a-python-program-under-windows">Como faço para executar um programa Python no Windows?</a></li>
<li><a class="reference internal" href="#how-do-i-make-python-scripts-executable">Como eu faço para criar programas Python executáveis?</a></li>
<li><a class="reference internal" href="#why-does-python-sometimes-take-so-long-to-start">Por que Python às vezes demora tanto para iniciar?</a></li>
<li><a class="reference internal" href="#how-do-i-make-an-executable-from-a-python-script">Como eu faço para criar um executável a partir de um código Python?</a></li>
<li><a class="reference internal" href="#is-a-pyd-file-the-same-as-a-dll">Um arquivo <code class="docutils literal notranslate"><span class="pre">*.pyd</span></code> é o mesmo que um DLL?</a></li>
<li><a class="reference internal" href="#how-can-i-embed-python-into-a-windows-application">Como eu posso embutir Python dentro de uma aplicação do Windows?</a></li>
<li><a class="reference internal" href="#how-do-i-keep-editors-from-inserting-tabs-into-my-python-source">Como eu impeço editores de adicionarem tabulações na minha source do Python?</a></li>
<li><a class="reference internal" href="#how-do-i-check-for-a-keypress-without-blocking">Como faço para verificar uma tecla pressionada sem bloquear?</a></li>
</ul>
</li>
</ul>

  <h4>Tópico anterior</h4>
  <p class="topless"><a href="extending.html"
                        title="capítulo anterior">FAQ sobre Extensão/Incorporação</a></p>
  <h4>Próximo tópico</h4>
  <p class="topless"><a href="gui.html"
                        title="próximo capítulo">FAQ da Interface Gráfica do Usuário</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Relatar um erro</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/3.10/Doc/faq/windows.rst"
            rel="nofollow">Exibir código-fonte
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegação</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice geral"
             >índice</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Índice de Módulos Python"
             >módulos</a> |</li>
        <li class="right" >
          <a href="gui.html" title="FAQ da Interface Gráfica do Usuário"
             >próximo</a> |</li>
        <li class="right" >
          <a href="extending.html" title="FAQ sobre Extensão/Incorporação"
             >anterior</a> |</li>

          <li><img src="../_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">3.10.4 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Perguntas Frequentes Sobre Python</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Python no Windows</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Busca rápida" aria-label="Busca rápida" type="text" name="q" />
          <input type="submit" value="Ir" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Direitos autorais</a> 2001-2022, Python Software Foundation.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="/license.html">History and License</a> for more information.<br />
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Última atualização em jun. 04, 2022.
    <a href="/bugs.html">Found a bug</a>?
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>

  </body>
</html>